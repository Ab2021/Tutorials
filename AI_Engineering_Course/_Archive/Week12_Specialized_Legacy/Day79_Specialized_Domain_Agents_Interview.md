# Day 79: Specialized Domain Agents (Code, Legal, Medical)
## Interview Questions & Production Challenges

### Interview Questions

#### Q1: What is the "Context Window" problem in Coding Agents and how do you solve it?

**Answer:**
- **Problem:** Codebases are millions of tokens. You can't fit the whole repo in context.
- **Solution:**
  - **Repo Map:** Send a high-level tree structure.
  - **RAG:** Retrieve only relevant files.
  - **Dependency Graph:** Retrieve imported files.

#### Q2: Why is "Hallucination" dangerous in Legal AI?

**Answer:**
- Lawyers have been sanctioned for submitting briefs with fake cases generated by ChatGPT.
- **Impact:** Loss of license, fines.
- **Mitigation:** RAG (Grounding), Citation Verification, Link to source PDF.

#### Q3: How does "DeepSeek-Coder" or "StarCoder" differ from GPT-4?

**Answer:**
- **Training Data:** Trained heavily on GitHub code, StackOverflow, and documentation.
- **Fill-in-the-Middle (FIM):** Trained to complete code in the middle of a file, not just at the end.
- **Performance:** Often better at syntax and API usage than general models.

#### Q4: What are the privacy requirements for Medical Agents?

**Answer:**
- **HIPAA:** Data must be encrypted, access logged, and BAA (Business Associate Agreement) signed with model provider.
- **De-identification:** Remove PII (Name, MRN) before sending to cloud models.
- **Local Models:** Prefer running BioMistral locally to avoid data leaving the hospital.

#### Q5: Explain the "LSP" (Language Server Protocol) tool for agents.

**Answer:**
- LSP is the standard protocol used by VS Code for autocomplete/errors.
- **Agent Use:** Agent can query LSP to "Find definition of function X" or "Get compile errors".
- **Benefit:** Ground truth. The agent doesn't have to guess if the code compiles; the LSP tells it.

---

### Production Challenges

#### Challenge 1: The "Delete Prod" Bug

**Scenario:** Coding agent tries to fix a bug and deletes the `main.py` file or drops the database.
**Root Cause:** Lack of sandboxing.
**Solution:**
- **Docker:** Run agent in an isolated container.
- **Git:** Agent works on a branch. Human reviews PR.
- **Read-Only:** Give agent read-only access to DB.

#### Challenge 2: Stale Documentation

**Scenario:** Agent reads docs saying "Use v1 API". Codebase uses "v2 API". Agent writes broken code.
**Root Cause:** RAG retrieved outdated docs.
**Solution:**
- **Code-First RAG:** Prioritize indexing the *code* itself over the *docs*. The code is the source of truth.

#### Challenge 3: Legal Reasoning Nuance

**Scenario:** Agent says "This is legal". It missed a subtle jurisdiction difference (NY vs CA law).
**Root Cause:** Model lacks specific legal training.
**Solution:**
- **Fine-tuning:** Train on legal briefs from specific jurisdictions.
- **Disclaimer:** "I am an AI, not a lawyer. Consult a professional."

#### Challenge 4: Medical Bias

**Scenario:** Agent diagnoses "Panic Attack" for a female patient presenting with heart attack symptoms.
**Root Cause:** Bias in training data (historical medical bias).
**Solution:**
- **Eval:** Test on diverse patient demographics.
- **Guidelines:** Hardcode clinical guidelines (if Chest Pain -> Check Heart) to override model bias.

#### Challenge 5: Infinite Debugging Loop

**Scenario:** Agent writes code -> Test Fails -> Agent tries same fix -> Test Fails.
**Root Cause:** Agent stuck in local minimum.
**Solution:**
- **Max Retries:** Stop after 3 attempts.
- **Hint:** Inject the error message and a hint ("Try checking the import path").

### System Design Scenario: AI Pair Programmer (Copilot)

**Requirement:** IDE extension that suggests code.
**Design:**
1.  **Context:** Capture Cursor position + Open Tabs + Recent Files.
2.  **Retrieval:** Use Jaccard similarity to find relevant snippets in other files.
3.  **Model:** Low-latency model (Codex/StarCoder) for completion.
4.  **UX:** Ghost text (Grey text). Tab to accept.
5.  **Privacy:** Filter secrets (API Keys) before sending to server.

### Summary Checklist for Production
- [ ] **Sandboxing:** Run coding agents in **Docker**.
- [ ] **Review:** All agent outputs must be **Human Reviewed** (PR/Contract).
- [ ] **Context:** Use **Repo Maps** for code understanding.
- [ ] **Privacy:** **De-identify** medical/legal data.
- [ ] **Verification:** Check **Citations** against a database.
